/*!
 * Copyright 2019-2020 ForgeRock AS. All Rights Reserved 
 *  Use of this code requires a commercial software license with ForgeRock AS. or with one of its affiliates. All use shall be exclusively subject to such license between the licensee and ForgeRock AS.
 */
(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-862bb4c4"],{"217c":function(e,t,s){"use strict";s("d936")},"3a54":function(e,t,s){},9731:function(e,t,s){"use strict";s("3a54")},a368:function(e,t,s){"use strict";s.r(t);var r=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("b-container",[s("b-row",[s("b-col",[s("div",{staticClass:"d-sm-flex my-4"},[s("div",{staticClass:"media"},[s("div",{staticClass:"rounded-circle fr-resource-circle text-light bg-primary mr-4"},[s("i",{class:e.setIcon})]),s("div",{staticClass:"media-body"},[s("h1",[e._v(e._s(e.displayName))]),s("h6",{staticClass:"text-muted"},[e._v(e._s(e.secondaryTitle))])])]),e.canChangePassword||e.canDelete?s("div",{staticClass:"ml-auto my-4 my-sm-0 align-self-center align-self-end"},[s("b-dropdown",{staticClass:"m-md-2",attrs:{id:"resourceActions",text:"Actions",right:"",variant:"primary"}},[e.canChangePassword?s("b-dropdown-item",{directives:[{name:"b-modal",rawName:"v-b-modal.resetModal",modifiers:{resetModal:!0}}]},[e._v(e._s(e.$t("pages.access.resetPassword")))]):e._e(),e.canDelete?s("b-dropdown-item",{directives:[{name:"b-modal",rawName:"v-b-modal.deleteModal",modifiers:{deleteModal:!0}}]},[e._v(e._s(e.$t("common.form.delete"))+" "+e._s(this.name))]):e._e()],1)],1):e._e()])])],1),s("b-tabs",{attrs:{"content-class":"mt-4","nav-class":"nav-bar-border","flex-column":"","flex-sm-row":""}},[s("b-tab",{attrs:{title:this.$t("pages.access.details"),active:""}},[e.displayProperties.length>0?s("fr-object-type-editor",{attrs:{"form-fields":e.formFields,"display-properties":e.displayProperties,"disable-save-button":e.disableSaveButton,"resource-path":e.resource+"/"+e.name+"/"+e.id}}):s("span",[e._v(" "+e._s(e.$t("pages.access.noAvailableProperties"))+" ")])],1),e._l(e.objectTypeProperties,(function(t){return s("b-tab",{key:t.propName+"_tab",attrs:{title:t.title}},[s("fr-object-type-editor",{attrs:{"form-fields":e.formFields[t.propName]||{},"sub-property-name":t.propName,"display-properties":e.getObjectTypeProperyDisplayProperties(t),"disable-save-button":t.readOnly,"resource-path":e.resource+"/"+e.name+"/"+e.id}})],1)})),e._l(e.relationshipProperties,(function(t){return["array"===t.type?s("b-tab",{key:t.propName+"_tab",attrs:{title:t.title}},[s("fr-relationship-array",{attrs:{parentResource:e.resource+"/"+e.name,parentId:e.id,relationshipArrayProperty:t}})],1):e._e()]})),e.showLinkedToTab?s("b-tab",{key:"linkedSystems_tab",attrs:{title:e.$t("pages.linkedSystems.tabName")}},[s("b-form-select",{staticClass:"mb-3 w-25",attrs:{options:e.selectOptions},on:{change:e.filterSelect},model:{value:e.linkedSelect,callback:function(t){e.linkedSelect=t},expression:"linkedSelect"}}),e._l(e.filteredLinkedSystems,(function(t,r){return s("div",{key:r,staticClass:"linked-system-card"},[s("h5",{staticClass:"mt-4 ml-2 mb-2 text-muted"},[e._v(e._s(r))]),s("fr-object-type-editor",{attrs:{"form-fields":t,"display-properties":e.linkedSystemsDisplayProperties[r],"disable-save-button":!0}})],1)}))],2):e._e()],2),e.canDelete?s("b-modal",{ref:"deleteModal",attrs:{id:"deleteModal",title:this.$t("pages.access.deleteModalTitle")}},[s("div",[e._v(" "+e._s(e.$t("pages.access.deleteConfirm"))+" "+e._s(this.name)+"? ")]),s("div",{staticClass:"w-100",attrs:{slot:"modal-footer"},slot:"modal-footer"},[s("div",{staticClass:"float-right"},[s("b-btn",{attrs:{type:"button",variant:"danger"},on:{click:e.deleteResource}},[e._v(e._s(e.$t("common.form.delete")))])],1)])]):e._e(),e.canChangePassword?s("b-modal",{ref:"resetModal",attrs:{id:"resetModal",title:this.$t("pages.access.resetPassword")}},[s("fr-password-policy-input",{attrs:{policyApi:e.resource+"/"+e.name+"/policyTest"},model:{value:e.formFields["password"],callback:function(t){e.$set(e.formFields,"password",t)},expression:"formFields['password']"}},[s("b-form-group",{staticClass:"mb-3",attrs:{slot:"custom-input"},slot:"custom-input"},[s("label",{attrs:{for:"updatePassword"}},[e._v(e._s(e.$t("pages.access.password")))]),s("div",{staticClass:"form-label-password form-label-group mb-0"},[s("b-form-input",{attrs:{id:"updatePassword",autocomplete:"password",type:e.passwordInputType,name:"password"},model:{value:e.formFields["password"],callback:function(t){e.$set(e.formFields,"password",t)},expression:"formFields['password']"}}),s("div",{staticClass:"input-group-append"},[s("button",{staticClass:"btn btn-secondary",attrs:{type:"button"},on:{click:e.revealNew}},[s("i",{class:[{"fa-eye-slash":!e.showPassword},{"fa-eye":e.showPassword},"fa"]})])])],1)])],1),s("div",{staticClass:"w-100",attrs:{slot:"modal-footer"},slot:"modal-footer"},[s("div",{staticClass:"float-right"},[s("b-btn",{attrs:{type:"button",variant:"primary"},on:{click:e.savePassword}},[e._v(e._s(e.$t("common.form.save")))])],1)])],1):e._e()],1)},i=[],a=s("2ef0"),o=s.n(a),n=s("cee4"),l=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("b-card",[s("ValidationObserver",{ref:"observer",attrs:{slim:""}},[e._l(e.displayProperties,(function(t,r){return[t.isReadOnly||e.disableSaveButton?["string"!==t.type&&"number"!==t.type||void 0!==t.encryption?e._e():s("b-form-group",{key:"readResource"+r,attrs:{label:t.title,"label-for":"field.key",horizontal:""}},[s("b-form-input",{attrs:{name:t.key,type:"text",disabled:!0},model:{value:e.formFields[t.key],callback:function(s){e.$set(e.formFields,t.key,s)},expression:"formFields[field.key]"}})],1),"boolean"===t.type?s("b-form-group",{key:"readResource"+r},[s("div",{staticClass:"form-row"},[s("label",{staticClass:"col-form-label col-sm-3",attrs:{for:t.title}},[e._v(e._s(t.title))]),s("b-form-checkbox",{staticClass:"mt-1 fr-toggle-primary",attrs:{switch:"",size:"lg",disabled:!0},model:{value:e.formFields[t.key],callback:function(s){e.$set(e.formFields,t.key,s)},expression:"formFields[field.key]"}},[e._v(" "+e._s(e.formFields[t.key]?e.$t("common.form.yes"):e.$t("common.form.no"))+" ")])],1)]):e._e(),"array"===t.type&&"relationship"!==t.items.type?s("b-form-group",{key:"readResource"+r},[s("div",{staticClass:"d-flex flex-column"},[s("label",{staticClass:"mr-auto",attrs:{for:t.title}},[e._v(e._s(t.title))]),s("FrListField",e._g({attrs:{value:e.formFields[t.key],description:t.description,items:t.items,label:t.title,name:t.name,required:t.required,index:r,disabled:!0},on:{input:function(s){return e.updateField(t.key,s)}}},e.$listeners))],1)]):e._e(),"relationship"===t.type?s("b-form-group",{key:"readResource"+r},[s("div",{staticClass:"form-row"},[s("label",{staticClass:"col-form-label col-sm-3",attrs:{for:t.title}},[e._v(e._s(t.title))]),e.formFields[t.key]?s("div",{staticClass:"media-body"},[s("div",{staticClass:"text-bold pl-1"},[e._v(e._s(e.formFields[t.key][e.getRelationshipDisplayFields(t,e.formFields[t.key])[0]]))]),s("div",e._l(e.getRelationshipDisplayFields(t,e.formFields[t.key]),(function(r,i){return s("span",{directives:[{name:"show",rawName:"v-show",value:0!==i,expression:"displayFieldIndex !== 0"}],key:"displayField_"+r+"_"+i,staticClass:"pl-1 pr-1 text-muted"},[e._v(" "+e._s(e.formFields[t.key][r])+" ")])})),0)]):e._e()])]):e._e()]:["string"===t.type||"number"===t.type||"boolean"===t.type||"array"===t.type||"relationship"===t.type?s("ValidationProvider",{key:"editResource"+t.key,attrs:{name:t.title,vid:t.key,rules:t.required?"required":""},scopedSlots:e._u([{key:"default",fn:function(i){return["string"!==t.type&&"number"!==t.type||void 0!==t.encryption?"relationship"===t.type?s("FrRelationshipEdit",{key:"editResource"+r,attrs:{relationshipProperty:t,index:r,value:e.formFields[t.key],setValue:e.setSingletonRelationshipValue}}):e._e():s("b-form-group",{attrs:{label:t.title,"label-for":"field.key",horizontal:""}},["string"===t.type?s("b-form-input",{ref:0===r?"focusInput":"",refInFor:!0,attrs:{name:t.key,type:"text",state:e.getValidationState(i),autocomplete:t.key},model:{value:e.formFields[t.key],callback:function(s){e.$set(e.formFields,t.key,"string"===typeof s?s.trim():s)},expression:"formFields[field.key]"}}):s("b-form-input",{ref:0===r?"focusInput":"",refInFor:!0,attrs:{horizontal:"",name:t.key,type:"number",state:e.getValidationState(i),autocomplete:t.key},model:{value:e.formFields[t.key],callback:function(s){e.$set(e.formFields,t.key,e._n(s))},expression:"formFields[field.key]"}}),s("b-form-invalid-feedback",[e._v(e._s(i.errors[0]))])],1),"boolean"===t.type?s("b-form-group",{key:"editResource"+r},[s("div",{staticClass:"form-row"},[s("label",{staticClass:"col-form-label col-sm-3",attrs:{for:t.title}},[e._v(e._s(t.title))]),s("b-form-checkbox",{staticClass:"mt-1 fr-toggle-primary",attrs:{switch:"",size:"lg"},model:{value:e.formFields[t.key],callback:function(s){e.$set(e.formFields,t.key,s)},expression:"formFields[field.key]"}},[e._v(" "+e._s(e.formFields[t.key]?e.$t("common.form.yes"):e.$t("common.form.no"))+" ")])],1)]):e._e(),"array"===t.type&&"relationship"!==t.items.type?s("b-form-group",{key:"editResource"+r},[t.viewable?s("div",{staticClass:"d-flex flex-column"},[s("label",{staticClass:"mr-auto",attrs:{for:t.title}},[e._v(e._s(t.title||t.description))]),s("FrListField",e._g({attrs:{value:e.formFields[t.key],description:t.description,items:t.items,label:t.title,name:t.name,required:t.required,index:r,disabled:!t.userEditable},on:{input:function(s){return e.updateField(t.key,s)}}},e.$listeners))],1):e._e()]):e._e()]}}],null,!0)}):e._e()]]}))],2),e.disableSaveButton?e._e():s("div",{staticClass:"float-right mt-4"},[s("b-btn",{attrs:{type:"button",variant:"primary"},on:{click:e.saveResource}},[e._v(e._s(e.$t("common.form.save")))])],1)],1)},c=[],d=s("1a3e"),p=s("f13c"),u=s("eea2"),f={name:"ObjectTypeEditor",components:{FrListField:d["a"],FrRelationshipEdit:p["a"]},props:{displayProperties:{type:Array,default:function(){return[]}},formFields:{type:Object,default:function(){}},resourcePath:{type:String,default:""},disableSaveButton:{type:Boolean,default:!1},isOpenidmAdmin:{type:Boolean,default:!1},subPropertyName:{type:String,default:null,required:!1}},mixins:[u["a"]],data:function(){return{oldFormFields:{}}},methods:{getRelationshipDisplayFields:function(e,t){return o.a.find(e.resourceCollection,{path:t._refResourceCollection}).query.fields},setSingletonRelationshipValue:function(e,t){this.formFields[e]=t},saveResource:function(){var e=this;this.$refs.observer.reset();var t=this.getRequestService();this.$refs.observer.validate().then((function(s){if(s){var r;if(e.subPropertyName){var i={},a={};i[e.subPropertyName]=o.a.clone(e.oldFormFields),a[e.subPropertyName]=o.a.clone(e.formFields),r=e.generateUpdatePatch(i,a)}else r=e.generateUpdatePatch(o.a.clone(e.oldFormFields),o.a.clone(e.formFields));t.patch(e.resourcePath,r).then((function(){e.oldFormFields=o.a.clone(e.formFields),e.displayNotification("success",e.$t("pages.access.successEdited",{resource:o.a.capitalize(e.name)}))}),(function(t){var s=e.findPolicyError(t.response,e.displayProperties);if(s.length>0){var r={};o.a.each(s,(function(e){e.exists&&(void 0!==r[e.field]?r[e.field].push(e.msg):r[e.field]=[e.msg])})),e.$refs.observer.setErrors(r)}else e.displayNotification("error",e.$t("pages.access.invalidEdit"))}))}else e.displayNotification("error",e.$t("pages.access.invalidEdit"))}))},updateField:function(e,t){this.formFields[e]=t,this.$forceUpdate()}},mounted:function(){this.displayProperties.forEach((function(e){var t=e.title&&e.title.length>0,s=e.description&&e.description.length>0;!t&&s&&(e.title=e.description)})),this.oldFormFields=o.a.clone(this.formFields)}},h=f,m=(s("9731"),s("2877")),y=Object(m["a"])(h,l,c,!1,null,null,null),b=y.exports,v=s("f8f2"),g=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"card mt-3"},[s("div",{directives:[{name:"show",rawName:"v-show",value:!e.relationshipArrayProperty.isReadOnly,expression:"!relationshipArrayProperty.isReadOnly"}],staticClass:"px-4 py-2"},[s("b-row",[s("b-col",{staticClass:"my-1",attrs:{md:"5"}},[s("b-btn",{staticClass:"mr-1",attrs:{type:"button",variant:"primary",id:"add_"+e.relationshipArrayProperty.key},on:{click:e.openCreateModal}},[s("i",{staticClass:"fa fa-plus mr-3"}),e._v(e._s(e.$t("common.form.new"))+" "+e._s(e.relationshipArrayProperty.title)+" ")]),s("b-button",{directives:[{name:"show",rawName:"v-show",value:e.selected.length>0,expression:"selected.length > 0"}],attrs:{variant:"outline-primary",id:"delete_"+e.relationshipArrayProperty.key},on:{click:function(t){return e.$bvModal.show(e.removeModalId)}}},[s("i",{staticClass:"fa fa-trash mr-3"}),e._v(e._s(e.$t("common.form.remove"))+" ")])],1),e.showFilter&&!e.disableSortAndSearch?s("b-col",{staticClass:"my-1",attrs:{md:"7"}},[s("div",{staticClass:"d-flex"},[s("b-input-group",[s("b-input-group-prepend",[s("div",{staticClass:"input-group-text inset"},[s("i",{staticClass:"fa fa-search"})])]),s("b-form-input",{staticClass:"inset-left inset-right",attrs:{placeholder:e.searchPlaceholder},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.search(t)}},model:{value:e.filter,callback:function(t){e.filter=t},expression:"filter"}}),s("b-input-group-append",[s("b-btn",{staticClass:"inset clear",attrs:{variant:"outline-default",disabled:!e.filter},on:{click:e.clear}},[s("i",{staticClass:"fa fa-times-circle"})])],1)],1)],1)]):e._e()],1)],1),s("b-table",{ref:"relationshipArrayGrid",staticClass:"mb-0",class:[{"hide-header":!e.gridData.length}],attrs:{"show-empty":"","table-responsive":"",stacked:"lg",fields:e.columns,items:e.gridData,"per-page":0,hover:e.tableHover,"no-local-sorting":!0,"sort-by":e.sortBy,"sort-desc":e.sortDesc,"sort-direction":e.sortDirection,selectable:!e.relationshipArrayProperty.isReadOnly,"selected-variant":"active"},on:{"update:sortBy":function(t){e.sortBy=t},"update:sort-by":function(t){e.sortBy=t},"update:sortDesc":function(t){e.sortDesc=t},"update:sort-desc":function(t){e.sortDesc=t},"row-clicked":e.resourceClicked,"row-selected":e.onRowSelected,"sort-changed":e.sortingChanged},scopedSlots:e._u([{key:"head(selected)",fn:function(){return[s("div",{directives:[{name:"show",rawName:"v-show",value:e.gridData.length>0,expression:"gridData.length > 0"}],staticClass:"cursor-pointer"},[s("b-form-checkbox",{staticClass:"pl-4",on:{change:e.toggleSelectAll},model:{value:e.allRowsSelected,callback:function(t){e.allRowsSelected=t},expression:"allRowsSelected"}})],1)]},proxy:!0},{key:"cell(selected)",fn:function(t){return[s("b-form-checkbox",{staticClass:"pl-4",attrs:{id:"rowSelectCheckbox_"+e.relationshipArrayProperty.key+t.index},on:{change:function(s){return e.onSelectRowCheckboxClicked(s,t.index)}},model:{value:t.rowSelected,callback:function(s){e.$set(t,"rowSelected",s)},expression:"data.rowSelected"}})]}},{key:"cell(_relationshipDetails)",fn:function(t){return[s("div",{staticClass:"media cursor-pointer"},[s("div",{staticClass:"media-body"},[s("div",{staticClass:"text-bold"},[e._v(e._s(t.value[0]))]),s("div",e._l(t.value,(function(t,r){return s("span",{directives:[{name:"show",rawName:"v-show",value:0!==r,expression:"index !== 0"}],key:"displayField_"+t+"_"+r,staticClass:"pr-1 text-muted"},[e._v(" "+e._s(t)+" ")])})),0)])])]}}])}),s("div",{directives:[{name:"show",rawName:"v-show",value:e.gridData.length,expression:"gridData.length"}],staticClass:"card-footer py-2"},[s("nav",{attrs:{"aria-label":"Page navigation example"}},[s("ul",{staticClass:"pagination justify-content-center mb-0"},[s("li",{class:[{disabled:1===e.currentPage},"page-item"],on:{click:function(t){t.preventDefault(),1!==e.currentPage&&e.paginationChange(1)}}},[e._m(0)]),s("li",{class:[{disabled:1===e.currentPage},"page-item"],on:{click:function(t){t.preventDefault(),1!==e.currentPage&&e.paginationChange(e.currentPage-1)}}},[e._m(1)]),s("li",{class:[{disabled:e.lastPage},"page-item"],on:{click:function(t){t.preventDefault(),!e.lastPage&&e.paginationChange(e.currentPage+1)}}},[e._m(2)])])])]),s("b-modal",{ref:e.createModalId,attrs:{id:e.createModalId,title:"Add "+e.relationshipArrayProperty.title}},[s("fr-relationship-edit",{attrs:{relationshipProperty:e.relationshipArrayProperty,index:0,setValue:e.addNewRelationship}}),s("div",{staticClass:"w-100",attrs:{slot:"modal-footer"},slot:"modal-footer"},[s("div",{staticClass:"float-right"},[s("b-btn",{attrs:{variant:"outline-secondary mr-2"},on:{click:function(t){return e.$bvModal.hide(e.createModalId)}}},[e._v(" "+e._s(e.$t("common.form.cancel"))+" ")]),s("b-btn",{attrs:{type:"button",variant:"primary",id:"save_new_"+e.relationshipArrayProperty.key,disabled:0===e.newRelationships.length},on:{click:e.saveNewRelationships}},[e._v(" "+e._s(e.$t("common.form.save"))+" ")])],1)])],1),s("b-modal",{ref:e.removeModalId,attrs:{id:e.removeModalId,title:e.$t("pages.access.removeModalTitle")}},[s("div",[e._v(" "+e._s(e.$t("pages.access.removeConfirm"))+" "+e._s(e.relationshipArrayProperty.title)+"? ")]),s("div",{staticClass:"w-100",attrs:{slot:"modal-footer"},slot:"modal-footer"},[s("div",{staticClass:"float-right"},[s("b-btn",{attrs:{variant:"btn-link text-danger mr-2"},on:{click:function(t){return e.$bvModal.hide(e.removeModalId)}}},[e._v(e._s(e.$t("common.form.cancel")))]),s("b-btn",{attrs:{type:"button",variant:"danger"},on:{click:e.removeRelationships}},[e._v(e._s(e.$t("common.form.remove")))])],1)])])],1)},k=[function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("a",{staticClass:"page-link",attrs:{href:"#"}},[s("i",{staticClass:"fa fa-angle-double-left"})])},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("a",{staticClass:"page-link",attrs:{href:"#"}},[s("i",{staticClass:"fa fa-angle-left"})])},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("a",{staticClass:"page-link",attrs:{href:"#"}},[s("i",{staticClass:"fa fa-angle-right"})])}],_=s("761a"),w=s.n(_);function P(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,r)}return s}function C(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?P(Object(s),!0).forEach((function(t){S(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):P(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function S(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}var F={name:"RelationshipArray",components:{"fr-relationship-edit":p["a"]},mixins:[u["a"]],props:{parentId:{type:String,required:!0},relationshipArrayProperty:{type:Object,required:!0},parentResource:{type:String,required:!0}},data:function(){return{gridPageSize:10,allRowsSelected:!1,tableHover:!0,gridData:[],columns:[],currentPage:1,sortBy:null,sortDesc:!1,filter:"",lastPage:!1,sortDirection:"asc",createModalId:"create_".concat(this.relationshipArrayProperty.propName,"_modal"),removeModalId:"delete_".concat(this.relationshipArrayProperty.propName,"_modal"),newRelationships:[],selected:[],showFilter:!1,queryThreshold:null,disableSortAndSearch:!1,requiredProps:["_ref","_refResourceCollection","_refResourceId","_refProperties"]}},watch:{gridData:function(){var e=this;this.columns=this.columns.map((function(t){return"actions"!==t.key&&(t.sortable=!e.disableSortAndSearch&&!e.queryThreshold||e.filter.length>=e.queryThreshold),t}))}},computed:{searchPlaceholder:function(){return this.queryThreshold?this.$t("pages.access.typeAtLeastAndEnterToSearch",{numChars:this.queryThreshold}):this.$t("pages.access.typeAndEnterToSearch")}},mounted:function(){this.loadGrid(1)},methods:{loadGrid:function(e){var t=this,s=this.getRequestService(),r=this.relationshipArrayProperty.items.resourceCollection[0].path.split("/")[1],i=this.$root.applicationStore.state.managedObjectsSettings,o=function(r){s.get(t.buildGridUrl(e,r)).then((function(e){e.data.pagedResultsCookie?t.lastPage=!1:t.lastPage=!0,t.relationshipArrayProperty.isReadOnly||t.columns.push({key:"selected",label:"",class:"checkbox-column"}),r?t.relationshipArrayProperty.items.resourceCollection[0].query.fields.forEach((function(e){t.columns.push({key:e,label:r.properties[e].title||w.a.singular(e),sortable:!0,sortDirection:"desc"})})):t.columns.push({key:"_relationshipDetails",label:w.a.singular(t.relationshipArrayProperty.title)}),t.gridData=[],t.setGridData(e.data.result,t.relationshipArrayProperty)})).catch((function(e){t.displayNotification("error",e.response.data.message)}))};if(i&&i[r]&&(this.queryThreshold=i[r].minimumUIFilterLength),Object(a["has"])(this.relationshipArrayProperty,"items.resourceCollection")&&1===this.relationshipArrayProperty.items.resourceCollection.length){var n=this.relationshipArrayProperty.items.resourceCollection[0];this.setDisableSortAndSearch(n),this.getSchema(this.relationshipArrayProperty.items.resourceCollection[0].path).then((function(e){t.showFilter=!0,o(e.data)}))}else o()},setDisableSortAndSearch:function(e){var t=this.$root.applicationStore.state.managedObjectsSettings,s=e.path.split("/")[0],r=e.path.split("/")[1];"role"===r&&"internal"===s&&(r="internalrole"),this.disableSortAndSearch=!(this.isOpenidmAdmin||!Object(a["has"])(t,r))&&t[r].disableRelationshipSortAndSearch},setGridData:function(e,t){var s=this,r=function(){e.forEach((function(e){var r=Object(a["find"])(t.items.resourceCollection,{path:e._refResourceCollection});r&&Object(a["has"])(r,"path")&&"internal/user"===r.path?e._relationshipDetails=[Object(a["last"])(e._ref.split("/"))]:e._relationshipDetails=r?Object(a["toArray"])(Object(a["pick"])(e,r.query.fields)):[e._id],s.gridData.push(e)}))};if(this.disableSortAndSearch){var i=[];e.forEach((function(r,o){var n=Object(a["find"])(t.items.resourceCollection,{path:r._refResourceCollection});i.push(s.getRelationshipFieldsData(r,n.query.fields).then((function(t){e[o]=C(C({},r),t)})))})),Promise.all(i).then((function(){r()}))}else r()},getRelationshipFieldsData:function(e,t){return this.getRequestService().get("".concat(e._ref,"?_fields=").concat(t)).then((function(e){return Object(a["pick"])(e.data,t)}))},buildGridUrl:function(e,t){var s=Object(a["find"])(this.relationshipArrayProperty.items.resourceCollection,{path:t?t.resourceCollection:null}),r=this.additionalQueryFilter?this.parentResource:"".concat(this.parentResource,"/").concat(this.parentId,"/").concat(this.relationshipArrayProperty.propName),i=this.filter?this.generateSearch(this.filter,s.query.fields,t.properties):"",o="".concat(r,"?_pageSize=").concat(this.gridPageSize,"&_totalPagedResultsPolicy=ESTIMATE");if(o=i?"".concat(o,"&_queryFilter=").concat(i):"".concat(o,"&_queryFilter=true"),!this.disableSortAndSearch&&s){var n=this.requiredProps.join(","),l=s.query.fields.join(",");o="".concat(o,"&_fields=").concat(n,",").concat(l)}if(e>1){var c=e*this.gridPageSize;o="".concat(o,"&_pagedResultsOffset=").concat(c)}if(this.sortBy){var d=null;Object(a["isNull"])(this.sortBy)||(d=this.sortDesc?"".concat(this.sortBy):"-".concat(this.sortBy)),o="".concat(o,"&_sortKeys=").concat(d)}return o},paginationChange:function(e){this.currentPage=e,this.loadGrid(e)},resourceClicked:function(e){this.$router.push({name:"EditResource",params:{resourceType:e._refResourceCollection.split("/")[0],resourceName:e._refResourceCollection.split("/")[1],resourceId:e._refResourceId}})},openCreateModal:function(){this.$bvModal.show(this.createModalId),this.newRelationships=[]},addNewRelationship:function(e,t){t&&this.newRelationships.push(t)},onRowSelected:function(e){this.selected=e,this.allRowsSelected=e.length===this.gridData.length},toggleSelectAll:function(e){e?this.$refs.relationshipArrayGrid.selectAllRows():this.$refs.relationshipArrayGrid.clearSelected()},saveNewRelationships:function(){this.updateRelationship("add",this.newRelationships)},removeRelationships:function(){var e=[],t=["_ref","_refResourceCollection","_refResourceId","_refProperties"];this.selected.forEach((function(s){s&&e.push(Object(a["pick"])(s,t))})),this.updateRelationship("remove",e)},updateRelationship:function(e,t){var s=this,r=Object(a["map"])(t,(function(t){return"remove"===e?{operation:"remove",field:"/"+s.relationshipArrayProperty.propName,value:t}:{operation:"add",field:"/"+s.relationshipArrayProperty.propName+"/-",value:t}})),i="remove"===e?"pages.access.successRemoved":"pages.access.successAdded",o=this.getRequestService(),n=function(){var t="remove"===e?s.removeModalId:s.createModalId;s.loadGrid(1),s.$bvModal.hide(t)};o.patch("".concat(this.parentResource,"/").concat(this.parentId),r).then((function(){n(),s.displayNotification("success",s.$t(i,{resource:s.relationshipArrayProperty.title}))})).catch((function(e){n(),s.displayNotification("error",e.response.data.message)}))},sortingChanged:function(e){this.currentPage=1,this.sortBy=e.sortBy,this.sortDesc=e.sortDesc,this.loadGrid(1)},clear:function(){this.filter="",this.sortBy=null,this.sortDesc=!1,this.currentPage=1,this.loadGrid(1)},search:function(){""!==this.filter?(this.sortBy=null,this.sortDesc=!1,this.currentPage=1,(!this.queryThreshold||!this.filter.length||this.filter.length>=this.queryThreshold)&&this.loadGrid(1)):this.clear()},onSelectRowCheckboxClicked:function(e,t){e?this.$refs.relationshipArrayGrid.selectRow(t):this.$refs.relationshipArrayGrid.unselectRow(t)}}},R=F,$=(s("217c"),Object(m["a"])(R,g,k,!1,null,"6807030e",null)),O=$.exports,x={name:"Edit-Resource",components:{"fr-object-type-editor":b,"fr-password-policy-input":v["a"],"fr-relationship-array":O},mixins:[u["a"]],data:function(){return{name:this.$route.params.resourceName,resource:this.$route.params.resourceType,id:this.$route.params.resourceId,displayProperties:[],canDelete:!1,canChangePassword:!1,passwordInputType:"password",showPassword:!0,disableSaveButton:!1,icon:"",displayNameField:"",displaySecondaryTitleField:"",formFields:{},oldFormFields:{},objectTypeProperties:{},relationshipProperties:{},linkedSystems:{},filteredLinkedSystems:{},linkedSystemsDisplayProperties:{},showLinkedToTab:!1,selectOptions:[this.$t("pages.linkedSystems.defaultDropdown")],linkedSelect:this.$t("pages.linkedSystems.defaultDropdown")}},mounted:function(){this.loadData()},methods:{loadData:function(){var e=this,t=this.getRequestService();n["a"].all([this.getSchema("".concat(this.resource,"/").concat(this.name)),t.get("privilege/".concat(this.resource,"/").concat(this.name,"/").concat(this.id))]).then(n["a"].spread((function(s,r){var i="";e.objectTypeProperties=e.getObjectTypeProperties(s.data,r.data),e.relationshipProperties=e.getRelationshipProperties(s.data,r.data),i=e.buildResourceUrl(),t.get(i).then((function(i){e.generateDisplay(s.data,r.data,i.data),t.post("sync?_action=getLinkedResources&resourceName=managed/".concat(e.name,"/").concat(e.id)).then((function(t){e.getLinkedSystemProperties(t.data)})).catch((function(t){t.response&&t.response.status&&403!==t.response.status&&e.displayNotification("error",t.response.data.message)}))})).catch((function(t){e.displayNotification("error",t.response.data.message)}))}))).catch((function(t){e.displayNotification("error",t.response.data.message)}))},getLinkedSystemProperties:function(e){var t=this;e.length&&(this.showLinkedToTab=!0,o.a.forEach(e,(function(e){var s=e.resourceName.split("/")[1];t.selectOptions.push(s),t.linkedSystems[s]=e.content,t.linkedSystemsDisplayProperties[s]=[],o.a.forEach(Object.keys(t.linkedSystems[s]),(function(e){"_id"!==e&&(t.linkedSystems[s][e]=o.a.toString(t.linkedSystems[s][e]),t.linkedSystemsDisplayProperties[s].push({title:o.a.startCase(e),key:e,propName:e,readOnly:!0,type:"string",userEditable:!1,viewable:!0}))})),t.filteredLinkedSystems=t.linkedSystems})))},filterSelect:function(e){if(e===this.$t("pages.linkedSystems.defaultDropdown"))this.filteredLinkedSystems=this.linkedSystems;else{var t={};t[e]=this.linkedSystems[e],this.filteredLinkedSystems=t}},buildResourceUrl:function(){var e="".concat(this.resource,"/").concat(this.name,"/").concat(this.id,"?_fields=*"),t=o.a.filter(this.relationshipProperties,{type:"relationship"});return t.length&&(e+=",".concat(o.a.map(t,(function(e){return e.propName+"/*"})).join(","))),e},getObjectTypeProperties:function(e,t){return o.a.pickBy(e.properties,(function(e,s){var r=t.VIEW.properties.includes(s)||t.UPDATE.properties.includes(s),i="object"===e.type&&e.viewable;return e.propName=s,e.readOnly=!t.UPDATE.properties.includes(s),i&&r}))},getObjectTypeProperyDisplayProperties:function(e){var t=this;return o.a.map(e.order,(function(s){var r=e.properties[s];return r.key=s,r.value=t.formFields[e.propName]&&t.formFields[e.propName][s]||null,e.readOnly&&!t.isOpenidmAdmin?r.disabled=!0:r.disabled=!1,e.properties[s]}))},getRelationshipProperties:function(e,t){return o.a.pickBy(e.properties,(function(e,s){var r=t.VIEW.properties.indexOf(s)>-1||t.UPDATE.properties.indexOf(s)>-1,i="relationship"===e.type||"array"===e.type&&"relationship"===e.items.type;return e.propName=s,i&&(e.isReadOnly=-1===t.UPDATE.properties.indexOf(s)),i&&r}))},generateDisplay:function(e,t,s){var r=this;this.oldFormFields=o.a.pick(s,t.VIEW.properties),t.DELETE.allowed&&(this.canDelete=!0),e.icon?this.icon=e.icon:this.icon="",o.a.each(this.oldFormFields,(function(e,t){r.$set(r.formFields,t,e)})),t.VIEW.allowed&&(0===t.UPDATE.properties.length&&(this.disableSaveButton=!0),o.a.each(this.mergePrivilegeProperties(t,e),(function(t){var s=e.properties[t.attribute];-1!==o.a.indexOf(e.required,t.attribute)&&(s.required=!0),"password"!==t.attribute||t.readOnly||(r.canChangePassword=!0),s.key=t.attribute,"_id"!==t.attribute&&"password"!==t.attribute&&0===r.displayNameField.length&&(r.displayNameField=t.attribute),"title"!==o.a.toLower(t.attribute)&&"email"!==o.a.toLower(t.attribute)&&"type"!==o.a.toLower(t.attribute)&&"mail"!==o.a.toLower(t.attribute)||0!==r.displaySecondaryTitleField.length||(r.displaySecondaryTitleField=t.attribute),o.a.isUndefined(r.formFields[t.attribute])&&("boolean"===s.type?(r.$set(r.formFields,t.attribute,!1),r.oldFormFields[t.attribute]=!1):(r.$set(r.formFields,t.attribute,""),r.oldFormFields[t.attribute]="")),t.readOnly&&(s.isReadOnly=!0),r.displayProperties.push(s)})))},deleteResource:function(){var e=this,t=this.getRequestService();this.$refs.deleteModal.hide(),t.delete("".concat(this.resource,"/").concat(this.name,"/").concat(this.id)).then((function(){e.displayNotification("success",e.$t("pages.access.deleteResource")),e.$router.push({name:"ListResource",params:{resourceType:e.resource,resourceName:e.name}})})).catch((function(t){e.displayNotification("error",t.response.data.message)}))},revealNew:function(){"password"===this.passwordInputType?(this.passwordInputType="text",this.showPassword=!1):(this.passwordInputType="password",this.showPassword=!0)},savePassword:function(){var e=this,t=this.getRequestService(),s=[{operation:"add",field:"/password",value:this.formFields["password"]}];this.$refs.resetModal.hide(),this.formFields["password"]="",t.patch("".concat(this.resource,"/").concat(this.name,"/").concat(this.id),s).then((function(){e.displayNotification("success",e.$t("pages.access.successSavePassword"))}),(function(){e.displayNotification("error",e.$t("pages.access.failedSavePassword"))}))},mergePrivilegeProperties:function(e,t){var s=[];return o.a.each(t.order,(function(t){var r=o.a.indexOf(e.VIEW.properties,t)>-1,i=o.a.indexOf(e.UPDATE.properties,t)>-1,a={attribute:t};i?s.push(a):r&&(a.readOnly=!0,s.push(a))})),s}},computed:{secondaryTitle:function(){var e="".concat(this.resource," - ").concat(this.name);return this.displaySecondaryTitleField.length>0&&(e=this.formFields[this.displaySecondaryTitleField]),e},displayName:function(){var e=this.id;return this.displayNameField.length>0&&(e=this.formFields[this.displayNameField]),e},setIcon:function(){var e="fa-cube";return this.icon.length>0&&(e=this.icon),"fa fa-3x ".concat(e)}}},D=x,A=(s("b2f5"),Object(m["a"])(D,r,i,!1,null,"203507ae",null));t["default"]=A.exports},b2f5:function(e,t,s){"use strict";s("d71f")},d71f:function(e,t,s){},d936:function(e,t,s){}}]);
//# sourceMappingURL=chunk-862bb4c4.589bfc8e.js.map